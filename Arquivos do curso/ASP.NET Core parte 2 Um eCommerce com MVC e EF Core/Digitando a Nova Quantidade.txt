Temos a função clickIncremento() e clickDecremento() em nosso código. Iremos testá-las na tela de carrinho, clicando sobre os botões de "+" e "-", depois que ela for atualizada por meio do atalho "F5".

Ao clicarmos sobre o botão "+" e atualizarmos a página, veremos que o valor de itens do carrinho aumenta, e ao clicarmos no botão "-" diminui. A numeração na caixa de texto está responsiva aos cliques do usuário, exatamente o que queríamos.

controle de quantidades do carrinho funcionando corretamente
Para finalizar a configuração da caixa de texto, queremos que o usuário possa digitar a quantidade de itens sem precisar fazer uso dos botões de "+" ou "-", gerando uma modificação direta no banco de dados.

Modificaremos a classe Carrinho, adicionando uma nova função chamada updateQuantidade(), que receberá o elemento html que será a própria caixa de texto, isto é, o nome do parâmetro será input. Em seguida, aproveitaremos trechos de código da mesma classe, retirando a linha data.Quantidade. Faremos outra modificação: para getData() passaremos input e não btn.

class Carrinho {
    clickIncremento(btn) { 
        let data = this.getData(btn);
        data.Quantidade++; 
        this.postQuantidade(data);
    }

    clickDecremento(btn) { 
        let data = this.getData(btn);
        data.Quantidade--;
        this.postQuantidade(data);
    }

    updateQuantidade(input) {
        let data = this.getData(input);
        this.postQuantidade(data);
    }

Para acessarmos updateQuantidade() iremos para Carrinho.cshtml e localizarmos o input e adicionaremos um novo evento chamado onblur, que será acionado para chamarmos na instância carrinho a função que criamos. Passaremos como parâmetro para updateQuantidade() o elemento this.

<input type="text" value="@(item.Quantidade)"
                               class="form-control text-center" />
                                                             onblur="carrinho.updateQuantidade(this)"/>
                        <span class="input-group-btn">
                            <button class="btn btn-default"
                                    onclick="clickIncremento(this)">
                                <span class="glyphicon-plus"></span>
                            </button>
Feitas essas modificações, poderemos ir até a página de carrinho e digitar um valor qualquer no campo de quantidade. Digitaremos 17 e apertaremos a tecla "Tab", desse modo a chamada será realizada para o banco de dados.

De volta ao Visual Studio, aa área "Pesquisador de Objetos", inspecionaremos a tabela dbo.ItemPedido.

tabela de item pedido
Ao final da tabela teremos o valor 17. O registro ocorrerá da mesma maneira se adicionarmos valores diferentes na caixa de texto, o que revela que conseguimos implementar a alteração de quantidades diretamente.

Id	PedidoId	PrecoUnitario	ProdutoId	Quantidade
1	1	49,90	54	1
2	1	49,90	3	1
3	1	49,90	65	1
4	1	49,90	37	1
5	2	49,90	2	1
6	2	49,90	1	1
7	2	49,90	3	1
8	3	49,90	3	1
9	4	49,90	1	1
1009	1004	49,90	2	1
2009	2004	49,90	2	1
3009	3004	49,90	2	1
4009	4004	49,90	2	1
5009	5004	49,90	1	1
6009	6004	49,90	14	1
7009	7004	49,90	2	1
8009	8004	49,90	1	1
9009	9004	49,90	2	1
10009	10004	49,90	1	1
11009	11004	49,90	2	1
12009	12004	49,90	2	177
13010	13005	49,90	1	17
NULL	NULL	NULL	NULL	NULL

